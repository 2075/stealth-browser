<!DOCTYPE html>
<html>
	<head>
		<title>Stealth Browser</title>

		<link rel="stylesheet" href="design/font/index.css">

		<link rel="stylesheet" href="design/header.css">
		<link rel="stylesheet" href="design/main.css">
		<link rel="stylesheet" href="design/navi.css">
		<link rel="stylesheet" href="design/site.css">

		<!-- Thanks much, DOMContentLoaded with ES6 Modules. -->
		<!-- One simply does not understand async imports.   -->
		<script>BROWSER_BINDINGS=[];</script>

	</head>
	<body>
		<header id="header">
			<div id="header-history">
				<button id="header-history-back" title="Visit earlier Site" disabled></button>
				<button id="header-history-next" title="Visit later site" disabled></button>
				<button id="header-history-load" title="Load/Refresh/Pause site" disabled></button>
			</div>
			<div id="header-address">
				<ul><li id="header-address-protocol" class="secure" title="Secure via HTTPS"></li></ul>
				<input class="active" type="text" placeholder="Enter URL or search query" spellcheck="false">
			</div>
			<div class="header-right">
				<div id="header-modes">
					<button id="header-modes-offline" class="active" title="Offline"></button>
					<button id="header-modes-covert" title="Covert"></button>
					<button id="header-modes-stealth" title="Stealth"></button>
					<button id="header-modes-online" title="Online"></button>
				</div>
				<div id="header-settings">
					<button id="header-settings-modes" title="Site Modes"></button>
					<button id="header-settings-requests" title="Site Requests"></button>
					<button id="header-settings-browser" title="Browser Settings"></button>
				</div>
			</div>
		</header>
		<aside id="navi"></aside>
		<main id="main">
			<iframe id="main-frame" sandbox="allow-scripts allow-same-origin" src="http://localhost:1337/test.html"></iframe>
		</main>
		<aside id="site-modes">
			<h3>Site Modes</h3>
			<table>
				<thead>
					<tr>
						<th>Domain</th>
						<th>Media</th>
						<th>Mode</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>old.reddit.com</td>
						<td class="site-media">
							<button title="Texts"></button>
							<button title="Images"></button>
							<button title="Videos"></button>
							<button title="Downloads"></button>
						</td>
						<td class="site-mode">
							<button title="Offline" disabled></button>
						</td>
					</tr>
					<tr>
						<td>i.imgur.com</td>
						<td class="site-media">
							<button title="Texts"></button>
							<button title="Images" class="active"></button>
							<button title="Videos" class="active"></button>
							<button title="Downloads"></button>
						</td>
						<td class="site-mode">
							<button title="Stealth" disabled></button>
						</td>
					</tr>
					<tr>
						<td>ddl.rarbg.to</td>
						<td class="site-media">
							<button title="Texts"></button>
							<button title="Images" class="active"></button>
							<button title="Videos"></button>
							<button title="Downloads" class="active"></button>
						</td>
						<td class="site-mode">
							<button title="Online" disabled></button>
						</td>
					</tr>
				</tbody>
			</table>
		</aside>
		<aside id="site-requests">
			<h3>Site Requests</h3>
		</aside>


		<!-- Browser Source -->
		<script type="module">

			import { Browser } from './source/Browser.mjs';
			import { Peer    } from './source/Peer.mjs';
			import { Sandbox } from './source/Sandbox.mjs';


			const browser = window.browser = new Browser({
				url: 'https://cookie.engineer'
			});

			if (BROWSER_BINDINGS.length > 0) {
				BROWSER_BINDINGS.forEach(callback => callback(browser));
				BROWSER_BINDINGS = [];
			}

			setTimeout(_ => {

				let tab1 = browser.create('https://cookie.engineer');
				let tab2 = browser.create('https://old.reddit.com/r/programming');
				let tab3 = browser.create('https://google.com');
				let tab4 = browser.create('about:settings');

				tab1.onload = _ => console.log('tab1.onload', tab1);
				tab2.onload = _ => console.log('tab2.onload', tab2);
				tab3.onload = _ => console.log('tab3.onload', tab3);
				tab4.onload = _ => console.log('tab4.onload', tab4);

				browser.show(tab4);

				tab1.load();
				tab2.load();
				tab3.load();
				tab4.load();

			}, 1000);

			if (typeof require === 'function') {
				require('nw.gui').Window.get().showDevTools();
			}

		</script>

		<!-- Browser Design -->
		<script src="design/header.js"></script>
		<script src="design/main.js"></script>
		<script src="design/navi.js"></script>
		<script src="design/site.js"></script>

		<!-- Browser Initialization -->
	</body>
</html>

